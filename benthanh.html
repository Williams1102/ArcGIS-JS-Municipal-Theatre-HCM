<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
	<title>3Dview</title>

	<style>
		html,
		body,
		#viewDiv {
			padding: 0;
			margin: 0;
			height: 100%;
			width: 100%;
		}

		#back {
			position: absolute;
			bottom: 20px;
		}

		#back i {
			background-image: url(app/public/img/back.svg);
			background-repeat: no-repeat;
			display: inline-block;
			width: 100px;
			height: 25px;
			padding-left: 25px;
			padding-top: 2px;
			margin: 10px;
			cursor: pointer;
			background-size: 20px;
		}
	</style>

	<link rel="stylesheet" href="https://js.arcgis.com/4.16/esri/themes/light/main.css" />
	<script src="https://js.arcgis.com/4.16/"></script>

	<script>
		require([
			"esri/Map",
			"esri/views/SceneView",
			"esri/layers/GeoJSONLayer",
			"esri/layers/SceneLayer", "esri/layers/GraphicsLayer", "esri/Graphic", "esri/request"
		], function (Map, SceneView, GeoJSONLayer, SceneLayer,
			GraphicsLayer, Graphic, esriRequest) {
			var url = 'http://localhost:3000/';
			var urlGeo = 'http://localhost:3000/';
			var urlJS = 'http://localhost:3000/';



			var createGraphic = function (data) {
				return new Graphic({
					geometry: data,
					symbol: data.symbol,
					attributes: data
				});
			};

			function getJsonData(param, onCloud = false) {
				//true when call api via server false when call via json-server localhost
				let _url;
				if (onCloud) _url = urlJS;
				else _url = url;

				esriRequest(_url + param, json_options).then(function (response) {
					var graphicsLayer = new GraphicsLayer();
					// console.log(_url + param);
					// console.log(response);
					if (onCloud) {
						response.data[0].data.forEach(function (data) {
							graphicsLayer.add(createGraphic(data));
						});
					}
					else {
						response.data.forEach(function (data) {
							graphicsLayer.add(createGraphic(data));
						});
					}
					map.add(graphicsLayer);
				});
			}

			function getGeoJsonData(param, rendererType, onCloud = false) {
				let _url;
				if (onCloud) _url = urlGeo;
				else _url = url;

				const newGeoJsonLayer = new GeoJSONLayer({
					url: _url + param
				});

				newGeoJsonLayer.renderer = rendererType;
				map.layers.add(newGeoJsonLayer);
			}

			function getGeoJsonDataWithRenderType(param, rendererType, onCloud = false) {
				let _url;
				if (onCloud) _url = urlGeo;
				else _url = url;

				const dataUrl = fetch(_url + param).then((data) => {
					data.json().then(json => {
						const newGeoJsonLayer = new GeoJSONLayer({ url: _url + param });

						newGeoJsonLayer.renderer = {
							type: "simple",
							symbol: {
								type: "polygon-3d",
								symbolLayers: [
									{
										type: "extrude",
										size: json.features[0].properties.height,
										material: {
											color: json.features[0].properties.color || "#F4F2EF",
										}
									}
								]
							}
						}
						map.layers.add(newGeoJsonLayer);

					})
				})

			}

			//declare
			const json_options = {
				query: {
					f: "json"
				},
				responseType: "json"
			};

			const map = new Map({
				basemap: "dark-gray-vector",
				layers: [] //end layers
			});


			// request json
			getJsonData("mainha");


			getGeoJsonData("left_gate1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 3.9,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})
		
			//them
			getGeoJsonData("a", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("b", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("c", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			for (let index = 1; index <= 19; index++) {

				getGeoJsonDataWithRenderType("front_gate" + index)
			}
			getGeoJsonDataWithRenderType("wall_front_right1")
			getGeoJsonDataWithRenderType("wall_front_right2")
			getGeoJsonDataWithRenderType("wall_front_right3")
			getGeoJsonDataWithRenderType("wall_front_right4")
			getGeoJsonDataWithRenderType("wall_front_right5")
			getGeoJsonDataWithRenderType("wall_front_right6")
			getGeoJsonDataWithRenderType("wall_front_right7")
			getGeoJsonDataWithRenderType("wall_front_right8")
			getGeoJsonDataWithRenderType("wall_front_right9")
			getGeoJsonDataWithRenderType("wall_front_right10")

			getGeoJsonDataWithRenderType("wall_front_left")
			getGeoJsonDataWithRenderType("wall_back_right")
			getGeoJsonDataWithRenderType("wall_back_left")

			getGeoJsonDataWithRenderType("lock_tower0")
			getGeoJsonDataWithRenderType("lock_tower1")

			getGeoJsonData("d", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("e", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("f", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("g", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("h", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("h1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("g1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("2", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("3", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("4", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("5", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("6", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("7", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("8", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("9", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("10", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("11", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("12", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("13", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("14", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("15", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("16", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("17", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("18", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("19", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("20", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("21", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("22", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("23", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("24", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23809312066896382,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("25", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("26", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("27", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("28", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50182962396684161,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("29", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50181669887479075,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("30", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.50181669887479075,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("31", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("32", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("33", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("34", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("35", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("36", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("37", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})


			getGeoJsonData("38", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.23810604576101468,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhotruoc1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935661882394925,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhotruoc1_1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935661882394925,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhotruoc1_2", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.447440836616806,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhotruoc1_3", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.447440836616806,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhosau1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935532631474416,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhosau1_1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935532631474416,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhosau1_2", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.447440836616806,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhosau1_3", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.447440836616806,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			
			getGeoJsonData("Mainhanhophai1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935661882394925,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhophai2", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935532631474416,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhophai3", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.447440836616806,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhophai4", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.447440836616806,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhotrai1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935661882394925,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})

			getGeoJsonData("Mainhanhotrai2", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.0935532631474416,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})
				getGeoJsonData("Mainhanhotrai3", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.447440836616806,
							material: {
								color: "#ed5334"
							}
						}
					]
				}
			})
			
			// request json buc tuong ben phai
			// getJsonData("buctuongbenphaicuatruoc");
				
			getGeoJsonData("Buctuongtruocphai_1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.8169318899581413,
							material: {
								color: "#F4F2EF"
							}
						}
					]
				}
			})
/* ======================================HUY CODE =========================================== */
getGeoJsonData("MaiSauPhiaDuoi_1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.896238807898953,
							material: {
								color: "white"
							}
						}
					]
				}
			})

			getGeoJsonData("Tuongtrencongsaubenphai", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.09325598603027,
							material: {
								color: "white"
							}
						}
					]
				}
			})
			getGeoJsonData("congngoaiphiasaubenphai_1", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.09325598603027,
							material: {
								color: "white"
							}
						}
					]
				}
			})
			getJsonData("maichephiasau");
			getGeoJsonData("congngoaiphiasaubentrai", {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 1.09325598603027,
							material: {
								color: "white"
							}
						}
					]
				}
			})
			
			
			
/* ======================================TAN CODE =========================================== */
				//graphic layer
			esriRequest('http://localhost:3000/tru1cube1', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben trai cong ra vao


			esriRequest('http://localhost:3000/tru1thanhngang', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben trai thanh chan ngang phia tren

			esriRequest('http://localhost:3000/tru3cube1', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben trai phia trong cong ra vao

			esriRequest('http://localhost:3000/tru13uppercube1', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben trai phia trong cong ra vao


			esriRequest('http://localhost:3000/tru14uppercube2', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben phai phia trong cong ra vao


			esriRequest('http://localhost:3000/tru2cube1', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben phai cong ra vao

			esriRequest('http://localhost:3000/tru2thanhngang', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben phai thanh chan ngang phia tren

			esriRequest('http://localhost:3000/tru4cube1', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});

				map.add(graphicsLayer);
			}); // tru ben phai phia trong cong ra vao

			// geojson layer
			const congdongtrubentraitru1 = new GeoJSONLayer({
				url: "http://localhost:3000/tru1cube2"
			});

			const congdongtrubentraitru2 = new GeoJSONLayer({
				url: "http://localhost:3000/tru1cube3"
			});

			const congdongtrubentraikhoibentren = new GeoJSONLayer({
				url: "http://localhost:3000/tru1cube4"
			});

			const congdongtrubentraikhoihinhbentren = new GeoJSONLayer({
				url: "http://localhost:3000/tru1cube5"
			});

			congdongtrubentraitru1.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.38675473252897,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubentraitru2.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.38675473252897,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubentraikhoibentren.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 2.33913145899714,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubentraikhoihinhbentren.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.810635923246082,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			map.layers.add(congdongtrubentraitru1);
			map.layers.add(congdongtrubentraitru2);
			map.layers.add(congdongtrubentraikhoibentren);
			map.layers.add(congdongtrubentraikhoihinhbentren);

			const congdongtrubenphaitru1 = new GeoJSONLayer({
				url: "http://localhost:3000/tru2cube2"
			});

			const congdongtrubenphaitru2 = new GeoJSONLayer({
				url: "http://localhost:3000/tru2cube3"
			});

			const congdongtrubenphaikhoibentren = new GeoJSONLayer({
				url: "http://localhost:3000/tru2cube4"
			});

			const congdongtrubenphaikhoihinhbentren = new GeoJSONLayer({
				url: "http://localhost:3000/tru2cube5"
			});

			congdongtrubenphaitru1.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.38675473252897,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubenphaitru2.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.38675473252897,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubenphaikhoibentren.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 2.33913145899714,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubenphaikhoihinhbentren.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 0.810635923246082,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			map.layers.add(congdongtrubenphaitru1);
			map.layers.add(congdongtrubenphaitru2);
			map.layers.add(congdongtrubenphaikhoibentren);
			map.layers.add(congdongtrubenphaikhoihinhbentren);

			const congdongtrubentraiphiatrongkhoitrubencanh1 = new GeoJSONLayer({
				url: "http://localhost:3000/tru3cube2"
			});

			const congdongtrubentraiphiatrongkhoitrubencanh2 = new GeoJSONLayer({
				url: "http://localhost:3000/tru3cube3"
			});

			congdongtrubentraiphiatrongkhoitrubencanh1.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 9.2334401843882,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubentraiphiatrongkhoitrubencanh2.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 5.29216601513417,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			map.layers.add(congdongtrubentraiphiatrongkhoitrubencanh1);
			map.layers.add(congdongtrubentraiphiatrongkhoitrubencanh2);

			const congdongtrubenphaiphiatrongkhoitrubencanh1 = new GeoJSONLayer({
				url: "http://localhost:3000/tru4cube2"
			});

			const congdongtrubenphaiphiatrongkhoitrubencanh2 = new GeoJSONLayer({
				url: "http://localhost:3000/tru4cube3"
			});

			congdongtrubenphaiphiatrongkhoitrubencanh1.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 9.2334401843882,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			congdongtrubenphaiphiatrongkhoitrubencanh2.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 5.29216601513417,
							material: {
								color: "white"
							}
						}
					]
				}
			};

			map.layers.add(congdongtrubenphaiphiatrongkhoitrubencanh1);
			map.layers.add(congdongtrubenphaiphiatrongkhoitrubencanh2);

/*================================================================TRung Code====================================*/
				// request json
			esriRequest('http://localhost:3000/face1', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});
				map.add(graphicsLayer);

			});
			esriRequest('http://localhost:3000/face2', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});
				map.add(graphicsLayer);

			});
			esriRequest('http://localhost:3000/facecube8910', json_options).then(function (response) {
				var graphicsLayer = new GraphicsLayer();
				console.log(response);
				response.data.forEach(function (data) {
					graphicsLayer.add(createGraphic(data));
				});
				map.add(graphicsLayer);

			});
			
			// geojson layer
			const geojsonLayer1 = new GeoJSONLayer({
				url: "http://localhost:3000/cube1"
			});
			const geojsonLayer2 = new GeoJSONLayer({
				url: "http://localhost:3000/cube2"
			});
			const geojsonLayer3 = new GeoJSONLayer({
				url: "http://localhost:3000/cube3"
			});
			geojsonLayer4 = new GeoJSONLayer({
				url: "http://localhost:3000/cube4"
			})
			geojsonLayer5 = new GeoJSONLayer({
				url: "http://localhost:3000/cube5"
			})
			geojsonLayer6 = new GeoJSONLayer({
				url: "http://localhost:3000/cube6"
			})
			geojsonLayer7 = new GeoJSONLayer({
				url: "http://localhost:3000/cube7"
			})
			geojsonLayer8 = new GeoJSONLayer({
				url: "http://localhost:3000/cube8"
			})
			geojsonLayer9 = new GeoJSONLayer({
				url: "http://localhost:3000/cube9"
			})
			geojsonLayer10 = new GeoJSONLayer({
				url: "http://localhost:3000/cube10"
			})
	
			geojsonLayer1.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.3867547325289706,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer2.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.3867547325289706,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer3.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 3.4454676382,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer4.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 9.2334401843882,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer5.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 5.30283689021305,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer6.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 5.30283689021305,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer7.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 9.2334401843882,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer8.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.3867547325289706,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer9.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 3.4454676382,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
			geojsonLayer10.renderer = {
				type: "simple",
				symbol: {
					type: "polygon-3d",
					symbolLayers: [
						{
							type: "extrude",
							size: 7.3867547325289706,
							material: {
								color: "#7eadf7"
							}
						}
					]
				}
			};
		
			map.layers.add(geojsonLayer1);
			map.layers.add(geojsonLayer2);
			map.layers.add(geojsonLayer3);
			map.layers.add(geojsonLayer4);
			map.layers.add(geojsonLayer5);
			map.layers.add(geojsonLayer6);
			map.layers.add(geojsonLayer7);
			map.layers.add(geojsonLayer8);
			map.layers.add(geojsonLayer9);
			map.layers.add(geojsonLayer10);
			

			//view
			const view = new SceneView({
				container: "viewDiv",
				map: map,
				camera: {
					position: [106.69851318273459, 10.771691940543342, 100],
					heading: 0,
					tilt: 0
				}
			});

			view.popup.defaultPopupTemplateEnabled = true;
		});

	</script>
</head>

<body>
	<div id="viewDiv"></div>
</body>

</html>